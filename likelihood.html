<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="nl" xml:lang="nl"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.2.280">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Statistiek met R - 10&nbsp; Maximum Likelihood</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./eda.html" rel="next">
<link href="./driehoekstest.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "Geen resultaten",
    "search-matching-documents-text": "Gevonden documenten",
    "search-copy-link-title": "Kopieer link om te zoeken",
    "search-hide-matches-text": "Extra overeenkomsten verbergen",
    "search-more-match-text": "meer overeenkomst in dit document",
    "search-more-matches-text": "meer overeenkomsten in dit document",
    "search-clear-button-title": "Wissen",
    "search-detached-cancel-button-title": "Annuleren",
    "search-submit-button-title": "Verzenden"
  }
}</script>

  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
    <div class="container-fluid d-flex justify-content-between">
      <h1 class="quarto-secondary-nav-title"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Maximum Likelihood</span></h1>
      <button type="button" class="quarto-btn-toggle btn" aria-label="Show secondary navigation">
        <i class="bi bi-chevron-right"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Statistiek met R</a> 
    </div>
      </div>
      <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
      </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">Inleiding</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./kansrekenen.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Kansrekening</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./kansverdelingen.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Kansverdelingen</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./variabelen.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Variabelen</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./toetsen.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Toetsen</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./z-toets.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Z-Toets</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./t-toets.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">t-toets</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./f-toets.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">F-Toets</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./chikwadraat.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Chi-Kwadraat toets</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./driehoekstest.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Driehoekstest</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./likelihood.html" class="sidebar-item-text sidebar-link active"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Maximum Likelihood</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./eda.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Exploratieve Data Analyse (EDA)</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./datasplit.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Data splitsen</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./kde.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Kernel Density Estimation</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./referenties.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Referenties</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">Bijlagen</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./normale-verdeling.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">A</span>&nbsp; <span class="chapter-title">Normale verdeling</span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Inhoudsopgave</h2>
   
  <ul>
  <li><a href="#sec-likelihood-bernoulli" id="toc-sec-likelihood-bernoulli" class="nav-link active" data-scroll-target="#sec-likelihood-bernoulli"><span class="toc-section-number">10.1</span>  Bernoulli verdeling</a></li>
  <li><a href="#sec-likelihood-normaal" id="toc-sec-likelihood-normaal" class="nav-link" data-scroll-target="#sec-likelihood-normaal"><span class="toc-section-number">10.2</span>  Normale verdeling</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title"><span id="sec-likelihood" class="quarto-section-identifier d-none d-lg-block"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Maximum Likelihood</span></span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<ul>
<li>Grootste Aannemelijkheid Methode</li>
<li>Maximum Likelihood Estimation (MLE)</li>
</ul>
<p>Een statistisch onderzoek wordt gedaan aan de hand van een gegevensverzameling, een verzameling van waarnemingen gedaan tijdens het onderzoek. Bij dit onderzoek wordt geprobeerd om een statistisch model te maken dat zo goed mogelijk bij de waarnemingen past. En zo’n statistisch model heeft vaak een of meerdere parameters. Een paar voorbeelden.</p>
<ul>
<li>De waarnemingen zijn de meetresultaten van de lengte van personen. Het model zou kunnen zijn dat de lengtes een normale verdelingen vormen. En een normale verdeling kent twee parameters: gemiddelde en standaarddeviatie.</li>
<li>De waarnemingen zijn de resultaten van het werpen met een munt: kop of munt. Het model heeft 1 parameter, bijvoorbeeld de kans op kop boven.</li>
<li>De waarnemingen zijn de opbrengsten van een bedrijf afhankelijk van het reclamebudget. Het model zou een lineair regressiemodel kunnen zijn. Een dergelijk model heeft als vergelijking <span class="math inline">\(y = a*x + b\)</span>. Dit model heeft twee parameters, <span class="math inline">\(a\)</span> en <span class="math inline">\(b\)</span>.</li>
</ul>
<p>Wanneer je de waarden van de parameters niet kent, dan probeer je die te schatten. Bijvoorbeeld van een normale verdeling probeer je het gemiddelde van de verdeling te schatten. Je zou dat kunnen doen door een steekproef te nemen en het gemiddelde van de steekproef als schatter voor het gemiddelde van de populatie te nemen. Maar is deze waarde dan wel de beste schatter?</p>
<p>Het steekproefgemiddelde is een toevalsvariabele (kansvariabele), want iedere steekproeftrekking levert een nieuwe waarde voor de te schatten parameter.</p>
<p>In een wat formelere taal.</p>
<ul>
<li><span class="math inline">\(\theta\)</span> = de te schatten parameter (bijv. het gemiddelde van een normale verdeling)</li>
<li><span class="math inline">\(S\)</span> = een schatter van <span class="math inline">\(\theta\)</span> en is een kansvariabele</li>
<li><span class="math inline">\(S\)</span> is een <strong>zuivere</strong> schatter wanneer <span class="math inline">\(E(S) = Θ\)</span>.</li>
<li><span class="math inline">\(S\)</span> is een <strong>efficiënte</strong> schatter wanneer <span class="math inline">\(Var(S)\)</span> minimaal is.</li>
</ul>
<p>De methode van de grootste aannemelijkheid (maximum likelihood) is een methode om de parameters van een statistisch model te schatten. De beste schatter is de waarde van de parameter die gezien de steekproefuitkomst het meest aannemelijk is. De beste schatter heet meest aannemelijke schatter, of maximum-likelihood-schatter, maximum likelihood estimate (MLE). En hoe waarschijnlijk de waarde van de parameter is wordt afgemeten aan de kans om bij die waarde van de parameter de steekproefuitkomst te vinden. De waarden voor de parameters moeten dus zodanig zijn dat de waarschijnlijkheid op de gevonden steekproefuitkomsten maximaal is.</p>
<p>De MLE methode maximaliseert de kans dat <span class="math inline">\(S\)</span> effectief is.</p>
<p>veel mensen hebben de neiging om aannemelijkheid en kans door elkaar te gebruiken, maar statistici maken onderscheid tussen de twee. Een Likelihood voor een statistisch model wordt gedefinieerd door dezelfde formule als de (kans)dichtheid, maar de rollen van de data <span class="math inline">\(x\)</span> en de parameter <span class="math inline">\(\theta\)</span> zijn verwisseld.</p>
<p><span class="math display">\[L_x(\theta) = f_\theta(x)\]</span></p>
<ul>
<li><p>$L_x() $ - De Likelihood is een functie van de parameter <span class="math inline">\(\theta\)</span> voor vaste gegevens <span class="math inline">\(x\)</span>.</p></li>
<li><p><span class="math inline">\(f_\theta(x)\)</span> - De dichtheid is een functie van de data <span class="math inline">\(x\)</span> voor vaste waarden van <span class="math inline">\(\theta\)</span>.</p></li>
</ul>
<div class="info">
<p><strong>Kleinste kwadratenmethode</strong></p>
<p>Minimalisatie van de kleinste kwadraten is een andere veelgebruikte methode voor het schatten van parameterwaarden voor een model. Het blijkt dat wanneer wordt aangenomen dat het model Gaussiaans is, de MLE-schattingen equivalent zijn aan de kleinste-kwadratenmethode.</p>
</div>
<section id="sec-likelihood-bernoulli" class="level2" data-number="10.1">
<h2 data-number="10.1" class="anchored" data-anchor-id="sec-likelihood-bernoulli"><span class="header-section-number">10.1</span> Bernoulli verdeling</h2>
<p>30 waarnemingen met uitkomst 1 (=succes) of 0 (= geen succes)</p>
<blockquote class="blockquote">
<p>1 1 1 0 1 0 1 1 1 1 0 1 0 1 0 1 1 1 1 1 0 0 1 1 1 1 0 1 1 1</p>
</blockquote>
<p>De succeskans van deze 30 waarnemingen = 22/30 = 0,7333. Wat is de MLE van de succeskans?</p>
<p>Veronderstel dat we uitgaan dat van een succeskans 0,7. Dan is de kans op waarneming 1 gelijk aan 0,7 en de kans op waarneming 0 gelijk aan 0,3. De totale kans op deze 30 waarnemingen (de Likelihood) is dan het product van deze 30 afzonderlijke kansen. En omdat het product van kansen zorgt voor extreem kleine getallen, wordt meestal overgestapt op de natuurlijke logaritme van de kansen. Dan kun je i.p.v. het product de som nemen. De logaritme is een monotoon stijgende functie en de logaritme van een functie bereikt de maximum waarde op hetzelfde punt als de functie zelf.</p>
<ul>
<li><strong>Likelihood</strong>: <span class="math inline">\(P(x_1) * P(x_2) * P(x_3) ... * P(x_{30})\)</span></li>
<li><strong>Log-Likelihood</strong>: <span class="math inline">\(LN(P(x_1)) + LN(P(x_2)) + LN(P(x_3)) ... + LN(P(x_{30}))\)</span></li>
</ul>
<p>In dit voorbeeld is bij een succeskans van 0,7 de Likelihood = <span class="math inline">\(0,7^{22}\times 0,3^{8} = 2,565*10^{-8}\)</span>. Zo kun je ook voor andere succeskansen steeds de Likelihood (totale kans) uitrekenen. De MLE is dan die kans waarvoor de Likelihood maximaal is. Dit is een iteratief proces.</p>
<p>In Excel kun je deze MLE met de <em>Oplosser</em> bepalen. Vanwege de zeer kleine waarden voor de Likelihood kan de <em>Oplosser</em> geen goed antwoord vinden. Bij de Log-Likelihood geeft de Oplosser als beste kans 0,7333. Dit is ook de theoretische waarde.</p>
<p>In R kun je een Likelihood functie definieren voor dit experiment en dan met functie <code>optimize</code> het maximum vinden.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># bereken dichtheid 22 keer succes bij 30 pogingen en kans op succe p.</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>likelihood <span class="ot">&lt;-</span> <span class="cf">function</span>(p) {</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">dbinom</span>(<span class="dv">22</span>, <span class="dv">30</span>, p)</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="fu">optimize</span>(<span class="at">f =</span> likelihood, <span class="at">interval =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>), <span class="at">maximum =</span> <span class="cn">TRUE</span>)</span></code><button title="Kopieer naar klembord" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$maximum
[1] 0.7333324

$objective
[1] 0.1628374</code></pre>
</div>
</div>
</section>
<section id="sec-likelihood-normaal" class="level2" data-number="10.2">
<h2 data-number="10.2" class="anchored" data-anchor-id="sec-likelihood-normaal"><span class="header-section-number">10.2</span> Normale verdeling</h2>
<p>Inspiratiebron: https://medium.com/<span class="citation" data-cites="lorenzojcducv/maximum-likelihood-for-the-normal-distribution-966df16fd031">@lorenzojcducv/maximum-likelihood-for-the-normal-distribution-966df16fd031</span></p>
<p>Kans: <span class="math inline">\(P(x|\mu,\sigma) = \frac{1}{\sigma\sqrt{2\pi}} e^{-\frac{1}{2}(\frac{x - \mu}{\sigma})^2}\)</span></p>
<p>Voor het vinden van de optimale parameters voor het gemiddelde <span class="math inline">\(\mu\)</span> en de standaarddeviatie <span class="math inline">\(sigma\)</span> gebruik je de Likelihood functie</p>
<p>Likelihood: <span class="math inline">\(L(\mu,\sigma |x) = \frac{1}{\sigma\sqrt{2\pi}} e^{-\frac{1}{2}(\frac{x - \mu}{\sigma})^2}\)</span></p>
<div id="exm-likelihood-1" class="theorem example">
<p><span class="theorem-title"><strong>Voorbeeld 10.1 </strong></span><strong>1 waarneming</strong></p>
<p>Meting gewicht (gram) van 1 gloeilamp: 32</p>
<p>Wat is de Likelihood voor een normale verdeling met <span class="math inline">\(\mu=28\)</span> en <span class="math inline">\(\sigma =2\)</span>?</p>
<p><span class="math inline">\(L(\mu=28,\sigma=2 |x=32) = \frac{1}{2\sqrt{2\pi}} e^{-\frac{1}{2}(\frac{32 - 28}{2})^2}\)</span> = 0.0269955</p>
<p>Zie de volgende tabel voor een aantal andere waarden van <span class="math inline">\(\mu\)</span>.</p>
<table class="table">
<thead>
<tr class="header">
<th style="text-align: center;"><span class="math inline">\(\mu\)</span></th>
<th style="text-align: center;"><span class="math inline">\(\sigma\)</span></th>
<th style="text-align: left;">L</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">28</td>
<td style="text-align: center;">2</td>
<td style="text-align: left;">0.0269955</td>
</tr>
<tr class="even">
<td style="text-align: center;">29</td>
<td style="text-align: center;">2</td>
<td style="text-align: left;">0.0647588</td>
</tr>
<tr class="odd">
<td style="text-align: center;">30</td>
<td style="text-align: center;">2</td>
<td style="text-align: left;">0.1209854</td>
</tr>
<tr class="even">
<td style="text-align: center;">31</td>
<td style="text-align: center;">2</td>
<td style="text-align: left;">0.1760327</td>
</tr>
<tr class="odd">
<td style="text-align: center;">32</td>
<td style="text-align: center;">2</td>
<td style="text-align: left;">0.1994711</td>
</tr>
<tr class="even">
<td style="text-align: center;">33</td>
<td style="text-align: center;">2</td>
<td style="text-align: left;">0.1760327</td>
</tr>
<tr class="odd">
<td style="text-align: center;">34</td>
<td style="text-align: center;">2</td>
<td style="text-align: left;">0.1209854</td>
</tr>
</tbody>
</table>
<p>De MLE voor <span class="math inline">\(\mu\)</span> wordt 32. Dit is een logische waarde, immers de uitkomst van de ene meting.</p>
</div>
<div id="exm-likelihood-2" class="theorem example">
<p><span class="theorem-title"><strong>Voorbeeld 10.2 </strong></span><strong>2 waarnemingen</strong></p>
<p>Meting gewicht (gram) van 2 gloeilampen: 32 en 34</p>
<p>Wat is de Likelihood voor een normale verdeling met <span class="math inline">\(\mu=30\)</span> en <span class="math inline">\(\sigma =2\)</span>?</p>
<p>De metingen zijn onafhankelijk van elkaar zodat het product van de afzonderlijke kansen kunt gebruiken.</p>
<div class="cell">

</div>
<p><span class="math inline">\(L(\mu=30,\sigma=2 |x=\{32, 34\}) = L(\mu=30,\sigma=2 |x=32) \times L(\mu=30,\sigma=2 |x=34)\)</span> = 0.0032661</p>
<p>Zie de volgende tabel voor een aantal andere waarden van <span class="math inline">\(\mu\)</span>.</p>
<table class="table">
<thead>
<tr class="header">
<th style="text-align: center;"><span class="math inline">\(\mu\)</span></th>
<th style="text-align: center;"><span class="math inline">\(\sigma\)</span></th>
<th style="text-align: left;">L</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">30</td>
<td style="text-align: center;">2</td>
<td style="text-align: left;">0.0032661</td>
</tr>
<tr class="even">
<td style="text-align: center;">31</td>
<td style="text-align: center;">2</td>
<td style="text-align: left;">0.0113997</td>
</tr>
<tr class="odd">
<td style="text-align: center;">32</td>
<td style="text-align: center;">2</td>
<td style="text-align: left;">0.0241331</td>
</tr>
<tr class="even">
<td style="text-align: center;">33</td>
<td style="text-align: center;">2</td>
<td style="text-align: left;">0.0309875</td>
</tr>
<tr class="odd">
<td style="text-align: center;">34</td>
<td style="text-align: center;">2</td>
<td style="text-align: left;">0.0241331</td>
</tr>
<tr class="even">
<td style="text-align: center;">35</td>
<td style="text-align: center;">2</td>
<td style="text-align: left;">0.0113997</td>
</tr>
</tbody>
</table>
<p>De MLE voor <span class="math inline">\(\mu\)</span> wordt nu 33, een logische waarde omdat dit het gemiddelde van de twee waarnemingen is.</p>
</div>
<p><strong>n waarnemingen</strong></p>
<p>In principe kun je de methode voor meerdere gegevenspunten uitbreiden. Je moet dan de afzonderlijke likelihood functies met elkaar vermenigvuldigen.</p>
<p><span class="math inline">\(L(\mu,\sigma |x=\{x_1, x_2, ..., x_n\}) = L(\mu,\sigma |x_1) \times L(\mu,\sigma |x_2) \times ... \times L(\mu,\sigma |x_n)\)</span></p>
<p><span class="math inline">\(= \frac{1}{\sigma\sqrt{2\pi}} e^{-\frac{1}{2}(\frac{x_1 - \mu}{\sigma})^2} \times ... \times \frac{1}{\sigma\sqrt{2\pi}} e^{-\frac{1}{2}(\frac{x_n - \mu}{\sigma})^2}\)</span></p>
<p>Voor het bepalen van de MLE moet je twee afgeleides bepalen en gelijk aan 0 stellen:</p>
<ul>
<li>Afgeleide naar <span class="math inline">\(\mu\)</span>, waarbij <span class="math inline">\(\sigma\)</span> als een constante behandeld wordt.</li>
<li>Afgeleide naar <span class="math inline">\(\sigma\)</span>, waarbij <span class="math inline">\(\mu\)</span> als een constante behandeld wordt.</li>
</ul>
<p>Het bepalen van de afgeleides gaat gemakkelijker via de logaritmes. De Log Likelihood functie wordt <span class="math inline">\(LL(\mu,\sigma|x) =ln(L(\mu,\sigma |x=\{x_1, x_2, ..., x_n\}))\)</span></p>
<p><span class="math inline">\(LL(\mu,\sigma|x) = ln(\frac{1}{\sigma\sqrt{2\pi}} e^{-\frac{1}{2}(\frac{x_1 - \mu}{\sigma})^2}) + ...+ ln(\frac{1}{\sigma\sqrt{2\pi}} e^{-\frac{1}{2}(\frac{x_n - \mu}{\sigma})^2})\)</span></p>
<p>Beschouw de eerste term.</p>
<p><span class="math inline">\(ln(\frac{1}{\sigma\sqrt{2\pi}} e^{-\frac{1}{2}(\frac{x_1 - \mu}{\sigma})^2}) = ln[(2\pi \sigma^2)^{-0.5}] -\frac{(x_1 - \mu)^2}{2\sigma^2}\)</span></p>
<p><span class="math inline">\(= -0.5ln(2\pi) - ln(\sigma) - \frac{(x_1 - \mu)^2}{2\sigma^2}\)</span></p>
<p>Wanneer je dit ook voor alle andere termen doet dan kun je de Log Likelihood functie omzetten in</p>
<p><span class="math inline">\(LL(\mu,\sigma|x) = -\frac{n}{2}ln(2\pi) - n ln(\sigma) - \sum_{i=1}^{n}\frac{(x_i - \mu)^2}{2 \sigma^2}\)</span></p>
<p><strong>Afgeleide naar</strong> <span class="math inline">\(\mu\)</span></p>
<p><span class="math inline">\(\frac{\partial}{\partial \mu} LL(\mu,\sigma|x) = \sum_{i=1}^{n} \frac{x_i - \mu}{\sigma^2} = \frac{1}{\sigma^2}(\sum_{i=1}^{n}x_i -n\mu)\)</span></p>
<p>Gelijkstelling aan nul levert</p>
<p><span class="math inline">\(\mu = \frac{1}{n}\sum_{i=1}^{n}x_i\)</span></p>
<p>De MLE voor <span class="math inline">\(\mu\)</span> is dus het gemiddelde van de waarnemingen.</p>
<p><strong>Afgeleide naar</strong> <span class="math inline">\(\sigma\)</span></p>
<p><span class="math inline">\(\frac{\partial}{\partial \sigma} LL(\mu,\sigma|x) = -\frac{n}{\sigma} + \sum_{i=1}^{n} \frac{(x_i - \mu)^2}{\sigma^3}\)</span></p>
<p>Gelijkstelling aan nul levert.</p>
<p><span class="math inline">\(\sum_{i=1}^{n} \frac{(x_i - \mu)^2}{\sigma^3} = \frac{n}{\sigma}\)</span> ofwel</p>
<p><span class="math inline">\(\sigma = \sqrt{\frac{\sum_{i=1}^{n}(x_i - \mu)^2}{n}}\)</span></p>
<p>De MLE voor <span class="math inline">\(\sigma\)</span> is dus de standaardafwijkingen van de waarnemingen.</p>
<p><strong>functie nlm</strong></p>
<p>De R-functie <code>nlm()</code> minimaliseert willekeurige functies geschreven in R. Voor het maximaliseren van de likelihood moet je als input de negatieve waarde van de log-likelihood gebruiken, immers minimaliseren van <span class="math inline">\(-f\)</span> komt overeen met het maximaliseren van <span class="math inline">\(f\)</span>.</p>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Gekopieerd!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Gekopieerd!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
    var links = window.document.querySelectorAll('a:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
          // target, if specified
          link.setAttribute("target", "_blank");
          // default icon
          link.classList.add("external");
      }
    }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./driehoekstest.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Driehoekstest</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./eda.html" class="pagination-link">
        <span class="nav-page-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Exploratieve Data Analyse (EDA)</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->



</body></html>