<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="nl" xml:lang="nl"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.2.280">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Statistiek met R - 13&nbsp; Kernel Density Estimation</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./referenties.html" rel="next">
<link href="./datasplit.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "Geen resultaten",
    "search-matching-documents-text": "Gevonden documenten",
    "search-copy-link-title": "Kopieer link om te zoeken",
    "search-hide-matches-text": "Extra overeenkomsten verbergen",
    "search-more-match-text": "meer overeenkomst in dit document",
    "search-more-matches-text": "meer overeenkomsten in dit document",
    "search-clear-button-title": "Wissen",
    "search-detached-cancel-button-title": "Annuleren",
    "search-submit-button-title": "Verzenden"
  }
}</script>

  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
    <div class="container-fluid d-flex justify-content-between">
      <h1 class="quarto-secondary-nav-title"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Kernel Density Estimation</span></h1>
      <button type="button" class="quarto-btn-toggle btn" aria-label="Show secondary navigation">
        <i class="bi bi-chevron-right"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Statistiek met R</a> 
    </div>
      </div>
      <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
      </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">Inleiding</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./kansrekenen.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Kansrekening</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./kansverdelingen.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Kansverdelingen</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./variabelen.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Variabelen</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./toetsen.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Toetsen</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./z-toets.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Z-Toets</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./t-toets.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">t-toets</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./f-toets.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">F-Toets</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./chikwadraat.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Chi-Kwadraat toets</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./driehoekstest.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Driehoekstest</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./likelihood.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Maximum Likelihood</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./eda.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Exploratieve Data Analyse (EDA)</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./datasplit.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Data splitsen</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./kde.html" class="sidebar-item-text sidebar-link active"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Kernel Density Estimation</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./referenties.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Referenties</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">Bijlagen</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./normale-verdeling.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">A</span>&nbsp; <span class="chapter-title">Normale verdeling</span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Inhoudsopgave</h2>
   
  <ul>
  <li><a href="#sec-kde-kansvariabelen" id="toc-sec-kde-kansvariabelen" class="nav-link active" data-scroll-target="#sec-kde-kansvariabelen"><span class="toc-section-number">13.1</span>  Kansvariabelen</a>
  <ul class="collapse">
  <li><a href="#sec-kde-var-discreet" id="toc-sec-kde-var-discreet" class="nav-link" data-scroll-target="#sec-kde-var-discreet"><span class="toc-section-number">13.1.1</span>  Discrete kansvariabele</a></li>
  <li><a href="#sec-kde-var-continu" id="toc-sec-kde-var-continu" class="nav-link" data-scroll-target="#sec-kde-var-continu"><span class="toc-section-number">13.1.2</span>  Continue kansvariabele</a></li>
  </ul></li>
  <li><a href="#sec-kde-kde" id="toc-sec-kde-kde" class="nav-link" data-scroll-target="#sec-kde-kde"><span class="toc-section-number">13.2</span>  KDE</a>
  <ul class="collapse">
  <li><a href="#sec-kde-kernel" id="toc-sec-kde-kernel" class="nav-link" data-scroll-target="#sec-kde-kernel"><span class="toc-section-number">13.2.1</span>  Kernel</a></li>
  <li><a href="#sec-kde-animatie" id="toc-sec-kde-animatie" class="nav-link" data-scroll-target="#sec-kde-animatie"><span class="toc-section-number">13.2.2</span>  Animatie voorbeeld</a></li>
  <li><a href="#sec-kde-uileg" id="toc-sec-kde-uileg" class="nav-link" data-scroll-target="#sec-kde-uileg"><span class="toc-section-number">13.2.3</span>  Nog een uitleg</a></li>
  </ul></li>
  <li><a href="#sec-kde-oefeningen" id="toc-sec-kde-oefeningen" class="nav-link" data-scroll-target="#sec-kde-oefeningen"><span class="toc-section-number">13.3</span>  Oefeningen</a>
  <ul class="collapse">
  <li><a href="#test-01" id="toc-test-01" class="nav-link" data-scroll-target="#test-01">Test 01</a></li>
  <li><a href="#test-02" id="toc-test-02" class="nav-link" data-scroll-target="#test-02">Test 02</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title"><span id="sec-kde" class="quarto-section-identifier d-none d-lg-block"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Kernel Density Estimation</span></span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<section id="sec-kde-kansvariabelen" class="level2" data-number="13.1">
<h2 data-number="13.1" class="anchored" data-anchor-id="sec-kde-kansvariabelen"><span class="header-section-number">13.1</span> Kansvariabelen</h2>
<p>Een <strong>kansvariabele</strong> (stochastische variabele, toevalsvariabele) is een grootheid waarvan de waarde een getal is dat afhangt van de toevallige uitkomst van een kansexperiment. Er kunnen twee soorten kansvariabelen onderscheiden worden:</p>
<ul>
<li><em>discrete</em> - waarbij de kansvariabele vaak wordt aangeduid met het symbool <span class="math inline">\(\underline{k}\)</span>.
<ul>
<li>Het aantal ogen bij één worp met een dobbelsteen.</li>
<li>Het aantal keren dat munt gegooid wordt bij 100 worpen met een munt.</li>
</ul></li>
<li><em>continue</em> - waarbij de kansvariabele vaak wordt aangeduid met het symbool <span class="math inline">\(\underline{x}\)</span>.
<ul>
<li>De wachttijd bij het bellen met een callcentre.</li>
<li>Het gewicht van personen</li>
</ul></li>
</ul>
<p>Bij een kansvariabele zijn de mogelijke uitkomsten bekend, liggen vast, maar de waargenomen waarde hangt af van het toeval. Een belangrijk aspect van een kansvariabele is de bijbehorende <strong>kansverdeling</strong>, die aangeeft wat de kansen zijn op de mogelijke waarden. Een kans ligt altijd tussen 0 en 1 en de som van alle kansen is 1.</p>
<p>De beschrijving van de kansen op de diverse uitkomsten wordt <strong>kansfunctie</strong> (in het discrete geval) of <strong>kansdichtheid</strong> (in het continue geval) genoemd.</p>
<section id="sec-kde-var-discreet" class="level3" data-number="13.1.1">
<h3 data-number="13.1.1" class="anchored" data-anchor-id="sec-kde-var-discreet"><span class="header-section-number">13.1.1</span> Discrete kansvariabele</h3>
<p>Bij een discrete kansvariabele <span class="math inline">\(\underline{k}\)</span> kan de <strong>kansfunctie</strong> <span class="math inline">\(f(k)\)</span> beschouwd worden als een weergave van de kansen.</p>
<p>Definitie: <span class="math inline">\(f(k) = P(\underline{k} = k)\)</span></p>
<p><strong>Worp met 1 dobbelsteen</strong></p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-kde-dobbelsteen" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="kde_files/figure-html/fig-kde-dobbelsteen-1.svg" class="img-fluid figure-img" style="width:100.0%"></p>
<p></p><figcaption class="figure-caption">Figuur&nbsp;13.1: Worp met 1 dobbelsteen</figcaption><p></p>
</figure>
</div>
</div>
</div>
<p>Dit is een discrete versie van een uniforme verdeling.</p>
<p>Vaak wordt er gewerkt met de <strong>verdelingsfunctie</strong> <span class="math inline">\(F(k)\)</span>. In plaats van te rekenen met losse kansen wordt er gerekend met <em>cumulatieve kansen</em>, <span class="math inline">\(F(k) = P(\underline{k} \le k)\)</span>. Deze functie geeft de kans aan dat de kansvariabele <span class="math inline">\(\underline{k}\)</span> een waarde aanneemt kleiner of gelijk aan een bepaalde grenswaarde <span class="math inline">\(k\)</span>.</p>
<p><span class="math inline">\(F(k) = \sum_{j \le k}f(j)\)</span></p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-kde-dobbelsteen-cumulatief" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="kde_files/figure-html/fig-kde-dobbelsteen-cumulatief-1.svg" class="img-fluid figure-img" style="width:100.0%"></p>
<p></p><figcaption class="figure-caption">Figuur&nbsp;13.2: Caumulatieve verdeling van de Worp met 1 dobbelsteen</figcaption><p></p>
</figure>
</div>
</div>
</div>
</section>
<section id="sec-kde-var-continu" class="level3" data-number="13.1.2">
<h3 data-number="13.1.2" class="anchored" data-anchor-id="sec-kde-var-continu"><span class="header-section-number">13.1.2</span> Continue kansvariabele</h3>
<p>Kon je bij een discrete kansvariabele de kansfunctie <span class="math inline">\(f(k)\)</span> punt voor punt omschrijven, bij een continue kansvariabele kan dat niet omdat ieder “los” punt een kans 0 heeft. Er zijn immers een overaftelbaar mogelijke uitkomsten, waardoor de kans dat een specifieke waarde precies wordt aangenomen, gelijk is aan nul. Daarom moet bij continue kansen altijd gekeken worden naar de kans dat de variabele in een bepaald interval ligt. Bijvoorbeeld dat de kans dat gewicht van een persoon tussen de 75,6 kg en 82,1 kg ligt.</p>
<p>Bij een continue variabele wordt de kans op een bepaalde waarde gedefinieerd met behulp van de <strong>kansdichtheid</strong> <span class="math inline">\(f(x)\)</span>.</p>
<p>Stel <span class="math inline">\(\underline{x}\)</span> is het lichaamsgewicht van een volwassen man met bijbehorende kansfunctie <span class="math inline">\(f(x)\)</span>, dan wordt in een grafiek van <span class="math inline">\(f(x)\)</span> de kans dat het gewicht van iemand tussen de 75 kg en 82 kg is weergegeven door het oppervlak tussen deze grenzen en kan dat berekend worden door te integreren:</p>
<p><span class="math inline">\(P(75 \lt \underline{x} \lt 80) = (75 \le \underline{x} \le 80) = \int_{75}^{80}f(x)dx\)</span></p>
<p>De cumulatieve verdelingsfunctie is gedefinieerd als</p>
<p><span class="math inline">\(F(x) = \int_{- \infty}^{y}f(y)dy\)</span> met <span class="math inline">\(f(y)\)</span> als een kansdichtheid</p>
<p>En de kansdichtheid is dan de afgeleide van de verdelingsfunctie: <span class="math inline">\(f(x) = F^{'}(x)\)</span></p>
</section>
</section>
<section id="sec-kde-kde" class="level2" data-number="13.2">
<h2 data-number="13.2" class="anchored" data-anchor-id="sec-kde-kde"><span class="header-section-number">13.2</span> KDE</h2>
<p>Wanneer je een dataset van een continue variabele hebt, dan is de kansdichtheid van die variabele onbekend. Er zijn een aantal methodes om die kansdiachtheid te schatten. Een goede indruk krijg je via een histogram. De keuze van de klassebreedte is hierbij erg belangrijk. Een andere methode is de Kernel Density Estimation (KDE), een vrij complexe techniek welke goede resultaten geeft.</p>
<section id="sec-kde-kernel" class="level3" data-number="13.2.1">
<h3 data-number="13.2.1" class="anchored" data-anchor-id="sec-kde-kernel"><span class="header-section-number">13.2.1</span> Kernel</h3>
<p>Bij de schatting van de kansdichtheid van de variabele worden kernels gebruikt, vandaar de naam.</p>
<p>Een <strong>kernel</strong> is een kansdichtheidsfunctie <span class="math inline">\(f(x)\)</span> met de volgende eigenschappen:</p>
<ul>
<li><span class="math inline">\(f(x)\)</span> is niet negatief</li>
<li><span class="math inline">\(f(x)\)</span> heeft reeele waarden</li>
<li><span class="math inline">\(f(x)\)</span> is even, d.w.z. f(x) = f(-x), dus symmetrisch rond Y-as</li>
<li>zijn definitieve integraal moet gelijk zijn aan 1</li>
</ul>
<p>Bekende kernels zijn de kansdichtheidsfuncties van de uniforme verdeling <span class="math inline">\(U[-1,1]\)</span> en de standaard normale (Gauss) verdeling <span class="math inline">\(N(0,1)\)</span>. Zie verder de lijst in <a href="https://en.wikipedia.org/wiki/Kernel_(statistics)#Kernel_functions_in_common_use">wikipedia</a>.</p>
<p>De werking van de KDE methode komt er op neer dat wanneer je binnen de kernel verschillende punten dicht bij elkaar hebt waargenomen, de kans op die waarden groter wordt.</p>
<p>In wezen wordt bij elk datapunt een kernelfunctie gemaakt met het datapunt in het midden - dit zorgt ervoor dat de kernel symmetrisch is ten opzichte van het datapunt. De kansdichtheidfunctie wordt vervolgens geschat door al deze kernelfuncties op te tellen en te delen door het aantal gegevens om er zeker van te zijn dat deze voldoet aan de 2 eigenschappen van een kansdichtheidfunctie:</p>
<ul>
<li>Iedere mogelijke waarde van functie f(x) is niet-negatief.</li>
<li>De definitieve integraal over het waardenbereik is 1. (totale kans = 1)</li>
</ul>
<p>Dit wordt fraai uitgebeeld in https://www.youtube.com/watch?v=x5zLaWT5KPs</p>
<p>Intuïtief is een kansdichtheidschatting van de kernel een som van “bulten”. Aan elk datapunt wordt een “bult” toegewezen, en de grootte van de “bult” geeft de waarschijnlijkheid weer die is toegewezen aan de waarden rond dat gegevenspunt. Dus als de dataset twee waarden bevat bij x=1,5 en 1 waarde bevat bij x=1, dan is de bult bij x=1,5 twee keer zo groot als de bult bij x=0,5.</p>
<p>Elke “bult” is gecentreerd op het datapunt en spreidt zich symmetrisch uit om de aangrenzende waarden van het datapunt te dekken. Elke kernel heeft een bandbreedte welke de breedte van de “hobbel” bepaalt (de breedte van de omgeving van waarden waaraan waarschijnlijkheid is toegewezen). Een grotere bandbreedte resulteert in een kortere en bredere “bult” die zich verder van het midden uitspreidt en meer waarschijnlijkheid toekent aan de aangrenzende waarden.</p>
<p>De KDE heeft twee cruciale componenten:</p>
<ul>
<li><strong>kernel</strong> - een dichtheidfunctie. Gebruikt worden normaal , uniforme , driehoekig , Epanechnikov , quartic , triweight en cosinus</li>
<li><strong>bandbreedte</strong> - vlakt de resulterende gegevens uit de dichtheidsfunctie van de kernel . De bandbreedte heeft dus grote invloed op de visuele weergave van de gegevens . Een scherpe lijn kan geleidelijk gladgestreken worden , totdat de gegevens zo zijn geparafraseerd , dat het niet langer zinvol is. In de formule voor de Kernel dichtheid schatting wordt de bandbreedte weergegeven door de letter <span class="math inline">\(h\)</span>.</li>
</ul>
</section>
<section id="sec-kde-animatie" class="level3" data-number="13.2.2">
<h3 data-number="13.2.2" class="anchored" data-anchor-id="sec-kde-animatie"><span class="header-section-number">13.2.2</span> Animatie voorbeeld</h3>
<p>Bron: <a href="https://mathisonian.github.io/kde/">Kernel Density Estimation, Matthew Conlen</a></p>
<p>Schatting van de kerneldichtheid is een erg handig statistisch hulpmiddel, vaak afgekort tot KDE. Het is een techniek waarmee je een vloeiende curve kunt maken op basis van een set gegevens.</p>
<p>Dit kan handig zijn als je alleen de “vorm” van sommige gegevens wilt visualiseren, als een soort continue vervanging van het discrete histogram. Het kan ook worden gebruikt om punten te genereren die eruitzien alsof ze uit een bepaalde dataset komen - dit gedrag kan eenvoudige simulaties mogelijk maken, waarbij gesimuleerde objecten worden gemodelleerd op basis van echte gegevens.</p>
<p>To understand how KDE is used in practice, lets start with some points. The white circles on your screen were sampled from some unknown distribution.</p>
<p>As more points build up, their silhouette will roughly correspond to that distribution, however we have no way of knowing its true value.</p>
<p>The blue line shows an estimate of the underlying distribution, this is what KDE produces.</p>
<p>The KDE algorithm takes a parameter, bandwidth, that affects how “smooth” the resulting curve is. Use the control below to modify bandwidth, and notice how the estimate changes.</p>
<p>Bandwidth: 0.10</p>
<p>The KDE is calculated by weighting the distances of all the data points we’ve seen for each location on the blue line. If we’ve seen more points nearby, the estimate is higher, indicating that probability of seeing a point at that location.</p>
<p>Move your mouse over the graphic to see how the data points contribute to the estimation — the “brighter” a selection is, the more likely that location is. The red curve indicates how the point distances are weighted, and is called the kernel function. The points are colored according to this function.</p>
<p>Changing the bandwidth changes the shape of the kernel: a lower bandwidth means only points very close to the current position are given any weight, which leads to the estimate looking squiggly; a higher bandwidth means a shallow kernel where distant points can contribute.</p>
<p>The concept of weighting the distances of our observations from a particular point, <span class="math inline">\(x\)</span> , can be expressed mathematically as follows:</p>
<p><span class="math inline">\(\hat{f}(x) = \sum_{observations} K(\frac{x - observation}{bandwith})\)</span></p>
<p>The variable <span class="math inline">\(K\)</span> represents the kernel function. Using different kernel functions will produce different estimates. Use the dropdown to see how changing the kernel affects the estimate.</p>
<p>Mogelijke functies: Epanechnikov, Normal, Uniform, Triangular, Gauss, …</p>
<p><a href="https://en.wikipedia.org/wiki/Kernel_density_estimation">Wikipedia</a></p>
<p>Hij heeft een fraaie animatie gemaakt m.b.v. <a href="https://idyll-lang.org/">Idyll</a></p>
<p>De broncode voor zijn animatie: <a href="https://github.com/mathisonian/kde/" class="uri">https://github.com/mathisonian/kde/</a></p>
</section>
<section id="sec-kde-uileg" class="level3" data-number="13.2.3">
<h3 data-number="13.2.3" class="anchored" data-anchor-id="sec-kde-uileg"><span class="header-section-number">13.2.3</span> Nog een uitleg</h3>
<p>Een kernel wordt gedefinieerd als een gladde functie K, zodanig dat <span class="math inline">\(K(x) \ge 0\)</span>, <span class="math inline">\(\int K(x) dx = 1\)</span>, <span class="math inline">\(\int x K(x) dx = 0\)</span> en <span class="math inline">\(\sigma^{2}_{K} = \int x^2 K(x) dx &gt; 0\)</span></p>
<p>Een voorbeeld van een Kernel is Gauss (Normaal) Kernel <span class="math inline">\(K(x) = (2\pi)^{-0,5} e^{-x^2/2}\)</span></p>
<p>Definitie: gegeven een kernel <span class="math inline">\(K\)</span> en een positief getal <span class="math inline">\(h\)</span>, genaamd de bandbreedte, dan wordt de KDE gedefinieerd als <span class="math inline">\(\hat{f}(x) = \frac{1}{n} \sum_{i=1}^{n}\frac{1}{h}K(\frac{x - X_i}{h})\)</span> met <span class="math inline">\(X_i\)</span> als gegevenspunt.</p>
<p>De bandbreedte <span class="math inline">\(h\)</span> controleert de hoeveelheid smoothing</p>
</section>
</section>
<section id="sec-kde-oefeningen" class="level2" data-number="13.3">
<h2 data-number="13.3" class="anchored" data-anchor-id="sec-kde-oefeningen"><span class="header-section-number">13.3</span> Oefeningen</h2>
<section id="test-01" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="test-01">Test 01</h3>
<p>Bron: <a href="https://statisticsglobe.com/kernel-density-plot-in-base-r">Create Kernel Density Plot in R (7 Examples) | density() Function</a></p>
<p>Allereerst wordt wat voorbeelddata gemaakt, in dit geval normaal verdeelde waarden</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">13531</span>)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">1000</span>)</span></code><button title="Kopieer naar klembord" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><strong>Histogram</strong></p>
<p>Eerst een histogram van de data</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(x, <span class="at">main =</span> <span class="st">"Histogram van x"</span>)</span></code><button title="Kopieer naar klembord" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="kde_files/figure-html/unnamed-chunk-5-1.svg" class="img-fluid figure-img" style="width:100.0%"></p>
</figure>
</div>
</div>
</div>
<p><strong>Basis KDE in standaard R</strong></p>
<p>Met functie <code>density()</code> kun je kernel density schattingen maken. Je kunt bandbreedte en de te gebruiken kernel specificeren</p>
<ul>
<li>kernel : “gaussian” (default), “epanechnikov”, “rectangular”, “triangular”, “biweight”, “cosine”, “optcosine”</li>
</ul>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">density</span>(x), <span class="at">main=</span><span class="st">"Kernel Density"</span>)</span></code><button title="Kopieer naar klembord" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="kde_files/figure-html/unnamed-chunk-6-1.svg" class="img-fluid figure-img" style="width:100.0%"></p>
</figure>
</div>
</div>
</div>
<p><strong>Histogram + density()</strong></p>
<p>Je kunt ook een dichtheidgrafiek over een histogram leggen.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(x, <span class="at">probability =</span> <span class="cn">TRUE</span>, <span class="at">main =</span> <span class="st">"Histogram van x"</span>)</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(<span class="fu">density</span>(x), <span class="at">col =</span> <span class="st">"red"</span>)</span></code><button title="Kopieer naar klembord" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="kde_files/figure-html/unnamed-chunk-7-1.svg" class="img-fluid figure-img" style="width:100.0%"></p>
</figure>
</div>
</div>
</div>
<p><strong>Vergelijking van een paar kernels</strong></p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">density</span>(x), <span class="at">col =</span> <span class="st">"black"</span>)</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(<span class="fu">density</span>(x, <span class="at">kernel =</span> <span class="st">"rectangular"</span>), <span class="at">col =</span> <span class="st">"red"</span>)</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(<span class="fu">density</span>(x, <span class="at">kernel =</span> <span class="st">"epanechnikov"</span>), <span class="at">col =</span> <span class="st">"blue"</span>)</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">"topright"</span>, </span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>       <span class="at">legend =</span> <span class="fu">c</span>(<span class="st">"gaussian"</span>, <span class="st">"rectangular"</span>, <span class="st">"epanechnikov"</span>), </span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>       <span class="at">col =</span> <span class="fu">c</span>(<span class="st">"black"</span>, <span class="st">"red"</span>, <span class="st">"blue"</span>),</span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>       <span class="at">lty =</span> <span class="dv">1</span>)</span></code><button title="Kopieer naar klembord" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="kde_files/figure-html/unnamed-chunk-8-1.svg" class="img-fluid figure-img" style="width:100.0%"></p>
</figure>
</div>
</div>
</div>
<p><strong>ggplot</strong></p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>()<span class="sc">+</span> <span class="fu">geom_density</span>(<span class="fu">aes</span>(<span class="at">x =</span> x))</span></code><button title="Kopieer naar klembord" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="kde_files/figure-html/unnamed-chunk-9-1.svg" class="img-fluid figure-img" style="width:100.0%"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="test-02" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="test-02">Test 02</h3>
<p>Bron: <a href="https://aakinshin.net/posts/kde-bw/">The importance of kernel density estimation bandwidth</a></p>
<p><a href="https://github.com/AndreyAkinshin/aakinshin.net/blob/master/content/en/posts/2020/10/kde-bw/index.md">GitHub</a></p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">21.370</span>, <span class="fl">19.435</span>, <span class="fl">20.363</span>, <span class="fl">20.632</span>, <span class="fl">20.404</span>, <span class="fl">19.893</span>, <span class="fl">21.511</span>, <span class="fl">19.905</span>, <span class="fl">22.018</span>, <span class="fl">19.93</span>, </span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>       <span class="fl">31.304</span>, <span class="fl">32.286</span>, <span class="fl">28.611</span>, <span class="fl">29.721</span>, <span class="fl">29.866</span>, <span class="fl">30.635</span>, <span class="fl">29.715</span>, <span class="fl">27.343</span>, <span class="fl">27.559</span>, <span class="fl">31.32</span>, </span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>       <span class="fl">39.693</span>, <span class="fl">38.218</span>, <span class="fl">39.828</span>, <span class="fl">41.214</span>, <span class="fl">41.895</span>, <span class="fl">39.569</span>, <span class="fl">39.742</span>, <span class="fl">38.236</span>, <span class="fl">40.460</span>, <span class="fl">39.36</span>, </span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>       <span class="fl">50.455</span>, <span class="fl">50.704</span>, <span class="fl">51.035</span>, <span class="fl">49.391</span>, <span class="fl">50.504</span>, <span class="fl">48.282</span>, <span class="fl">49.215</span>, <span class="fl">49.149</span>, <span class="fl">47.585</span>, <span class="fl">50.03</span>)</span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">density</span>(x, <span class="at">bw =</span> <span class="dv">5</span>))</span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">density</span>(x, <span class="at">bw =</span> <span class="dv">2</span>))</span></code><button title="Kopieer naar klembord" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="kde_files/figure-html/unnamed-chunk-10-1.svg" class="img-fluid figure-img" style="width:100.0%"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="kde_files/figure-html/unnamed-chunk-10-2.svg" class="img-fluid figure-img" style="width:100.0%"></p>
</figure>
</div>
</div>
</div>
<p>Interessant artikel dat nog veel verder gaat.</p>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Gekopieerd!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Gekopieerd!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
    var links = window.document.querySelectorAll('a:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
          // target, if specified
          link.setAttribute("target", "_blank");
          // default icon
          link.classList.add("external");
      }
    }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./datasplit.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Data splitsen</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./referenties.html" class="pagination-link">
        <span class="nav-page-text"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Referenties</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->



</body></html>